<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.rocketkurly.Categorie.dao">

	<select id="selectCCat" resultType="CategoriesVO">
	select c.p_category_id,p.p_category_name,s.c_category_id,s.sub_name
	from c_category c, sub_category s, p_category p
	where c.c_category_id = s.c_category_id and p.p_category_id = c.p_category_id

	</select>
	
	<select id="selectPCat" resultType="CategoriesVO" >
	select p_category_id, p_category_name
	from p_category

	</select>

	<select id="selectCategory" parameterType="String" resultType="CategoriesDomain" >
   select c.c_category_id, LISTAGG(s.sub_name,',') WITHIN GROUP(ORDER BY c.c_category_id) AS sub_name
   from p_category p
   inner join c_category c
   on p.p_category_id = c.p_category_id
   inner join sub_category s
   on c.c_category_id = s.c_category_id
   where p.p_category_id = #{p_category_id}
   GROUP BY c.c_category_id

	</select>

</mapper>